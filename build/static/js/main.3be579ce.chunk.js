(this.webpackJsonpvehiclecontrol=this.webpackJsonpvehiclecontrol||[]).push([[0],{14:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(4),i=t.n(l),c=t(7),s=t(2),o={avl_data:[],fleetcomplete_data:[],cad_data:[],unit_data:[],filtered_avl_data:[],filtered_fleetcomplete_data:[],filtered_cad_data:[],filtered_unit_data:[],avl_data_filter:"",fleetcomplete_data_filter:"",cad_data_filter:"",unit_data_filter:"",avl_data_sort_field:"device_id",fleetcomplete_data_sort_field:"",cad_data_sort_field:"",unit_data_sort_field:"",avl_data_sort_ascending:!0,fleetcomplete_data_sort_ascending:!0,cad_data_sort_ascending:!0,unit_data_sort_ascending:!0,avl_data_special_filter:"",fleetcomplete_data_special_filter:"",cad_data_special_filter:"",unit_data_special_filter:""},d=r.a.createContext(o);function _(e,a){switch(a.type){case"get_avl_data":return Object(s.a)({},e,{avl_data:a.payload,filtered_avl_data:m(a.payload,e.avl_data_filter,e.avl_data_sort_field,e.avl_data_sort_ascending,e.avl_data_special_filter)});case"search_avl_data":return Object(s.a)({},e,{filtered_avl_data:m(e.avl_data,a.payload,e.avl_data_sort_field,e.avl_data_sort_ascending,e.avl_data_special_filter),avl_data_filter:a.payload});case"avl_data_special_filter":return Object(s.a)({},e,{filtered_avl_data:m(e.avl_data,e.avl_data_filter,e.avl_data_sort_field,e.avl_data_sort_ascending,a.payload),avl_data_special_filter:a.payload});case"avl_data_sort":var t=u(e.filtered_avl_data,a.payload,!e.avl_data_sort_ascending);return Object(s.a)({},e,{filtered_avl_data:t,avl_data_sort_field:a.payload,avl_data_sort_ascending:!e.avl_data_sort_ascending});case"avl_data_toggle_show_errors":var n=e.filtered_avl_data.map((function(e){return e.device_id===a.payload&&(e.show_errors=!e.show_errors),e}));return Object(s.a)({},e,{filtered_avl_data:n});case"avl_data_toggle_show_unit_options":var r=e.filtered_avl_data.map((function(e){return e.device_id===a.payload&&(e.show_unit_options=!e.show_unit_options),e}));return Object(s.a)({},e,{filtered_avl_data:r});default:return e}}function u(e,a,t){return["updated_on","location_timestamp"].indexOf(a)>-1?function(e,a,t){return e.sort((function(e,n){return new Date(e[a])>new Date(n[a])?t?1:-1:new Date(n[a])>new Date(e[a])?t?-1:1:0}))}(e,a,t):e.sort((function(e,n){return e[a]>n[a]?t?1:-1:n[a]>e[a]?t?-1:1:0}))}function m(e,a,t,n,r){return u(function(e,a){if(0===a.length)return e;switch(a){case"error":return e.filter((function(e){return e.error_information.length>0}));case"date":return e.filter((function(e){return e.has_date_error}));case"location":return e.filter((function(e){return e.has_location_error}));case"unit":return e.filter((function(e){return e.has_unit_error}));default:return e}}(function(e,a){if(0===a.length)return e;var t=a.toLowerCase();return e.filter((function(e){return e.device_id.toLowerCase().indexOf(t)>-1||e.unitcode.toLowerCase().indexOf(t)>-1}))}(e,a),r),t,n)}var v=t(1),f=t.n(v),p=function(){return r.a.createElement("nav",{className:"navbar is-primary",role:"navigation","aria-label":"main navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("h1",{className:"navbar-item is-size-3 has-text-weight-bold"},"Vehicle Control")),r.a.createElement("div",{className:"navbar-menu"},r.a.createElement("div",{className:"navbar-start"},r.a.createElement("p",{className:"navbar-item is-tab cursor_pointer"},"Units"),r.a.createElement("p",{className:"navbar-item is-tab is-active cursor_pointer"},"AVL"),r.a.createElement("p",{className:"navbar-item is-tab cursor_pointer"},"Fleet Complete"),r.a.createElement("p",{className:"navbar-item is-tab cursor_pointer"},"CAD")),r.a.createElement("div",{className:"navbar-end"},r.a.createElement("p",{className:"navbar-item"},"BaseMap"),r.a.createElement("p",{className:"navbar-item"},"Layers"))))},h=t(5),E=t(6);function y(e){var a;return f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.awrap(fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}));case 2:if((a=t.sent).ok){t.next=5;break}throw new Error(a.statusText);case 5:return t.next=7,f.a.awrap(a.json());case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}))}function g(e){return e instanceof Date?e.toLocaleString("en-us"):new Date(e).toLocaleString("en-US")}var N=function(){function e(){Object(h.a)(this,e),this.device_id="",this.device_type="",this.unitcode="",this.direction=0,this.location_timestamp=new Date,this.satellite_count=0,this.velocity=0,this.latitude=0,this.longitude=0,this.updated_on=new Date,this.error_information=[],this.show_unit_options=!1,this.show_errors=!1,this.has_date_error=!1,this.has_location_error=!1,this.has_unit_error=!1}return Object(E.a)(e,null,[{key:"Get",value:function(){var e;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(y("API/AVL/Get"));case 2:return e=a.sent,a.abrupt("return",e);case 4:case"end":return a.stop()}}))}}]),e}(),b=function(e){return e.show_errors?r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",{colSpan:e.colspan-1},r.a.createElement("ul",null,e.error_information.map((function(e,a){return r.a.createElement("li",{key:a},e)}))))):null},w=function(e){return e.show_unit_options?r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",{className:"has-text-right"},"Current Unit:"),r.a.createElement("td",null,0===e.unitcode.length?"None":e.unitcode),r.a.createElement("td",{className:"has-text-right"},"Change To:"),r.a.createElement("td",{colSpan:2},r.a.createElement("div",{className:"field has-addons"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input is-small",type:"text",placeholder:"New Unit"})),r.a.createElement("div",{className:"control"},r.a.createElement("button",{type:"button",className:"button is-success is-small"},"Save"))))):null},x=function(e){var a=r.a.useContext(d).dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",null,r.a.createElement("td",null,e.device_id),r.a.createElement("td",null,e.device_type),r.a.createElement("td",null,r.a.createElement("span",{className:"cursor_pointer has-text-link",onClick:function(t){a({type:"avl_data_toggle_show_unit_options",payload:e.device_id})}},0===e.unitcode.length?"Add":e.unitcode)),r.a.createElement("td",null,g(e.updated_on)),r.a.createElement("td",null,g(e.location_timestamp)),r.a.createElement("td",null,e.error_information.length>0?r.a.createElement("span",{className:"cursor_pointer has-text-link",onClick:function(t){a({type:"avl_data_toggle_show_errors",payload:e.device_id})}},"Errors"):"")),r.a.createElement(w,Object.assign({colspan:6,new_unitcode:""},e)),r.a.createElement(b,{colspan:6,error_information:e.error_information,show_errors:e.show_errors}))},C=function(){var e=r.a.useContext(d),a=e.state,t=e.dispatch;return r.a.createElement("section",null,r.a.createElement("div",{style:{padding:"1em",marginBottom:0},className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-3 has-text-weight-bold"},"AVL"),r.a.createElement("div",{className:"level-item"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{type:"text",placeholder:"Search",onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),t({type:"search_avl_data",payload:e.target.value}))}}))))),r.a.createElement("div",{className:"level-right"},r.a.createElement("p",{className:"level-item has-text-weight-bold"},"Quick Filters"),r.a.createElement("div",{className:"level-item tabs"},r.a.createElement("ul",null,r.a.createElement("li",{className:"".concat(""===a.avl_data_special_filter?"is-active":"")},r.a.createElement("a",{href:"#NoFilter",onClick:function(e){t({type:"avl_data_special_filter",payload:""})}},"No Filter")),r.a.createElement("li",{className:"".concat("error"===a.avl_data_special_filter?"is-active":"")},r.a.createElement("a",{href:"#AllErrors",onClick:function(e){t({type:"avl_data_special_filter",payload:"error"})}},"All Errors")),r.a.createElement("li",{className:"".concat("unit"===a.avl_data_special_filter?"is-active":"")},r.a.createElement("a",{href:"#UnitErrors",onClick:function(e){t({type:"avl_data_special_filter",payload:"unit"})}},"Unit Errors")),r.a.createElement("li",{className:"".concat("date"===a.avl_data_special_filter?"is-active":"")},r.a.createElement("a",{href:"#DateErrors",onClick:function(e){t({type:"avl_data_special_filter",payload:"date"})}},"Date Errors")),r.a.createElement("li",{className:"".concat("location"===a.avl_data_special_filter?"is-active":"")},r.a.createElement("a",{href:"#LocationErrors",onClick:function(e){t({type:"avl_data_special_filter",payload:"location"})}},"Location Errors")))))),r.a.createElement("table",{className:"table is-fullwidth"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement("a",{href:"#SortByDeviceId",onClick:function(e){e.preventDefault(),t({type:"avl_data_sort",payload:"device_id"})},className:"".concat("device_id"!==a.avl_data_sort_field?"":a.avl_data_sort_ascending?"sort_ascending":"sort_descending")},"Device Id")),r.a.createElement("th",null,r.a.createElement("a",{href:"#SortByDeviceType",onClick:function(e){e.preventDefault(),t({type:"avl_data_sort",payload:"device_type"})},className:"".concat("device_type"!==a.avl_data_sort_field?"":a.avl_data_sort_ascending?"sort_ascending":"sort_descending")},"Device Type")),r.a.createElement("th",null,r.a.createElement("a",{href:"#SortByUnit",onClick:function(e){e.preventDefault(),t({type:"avl_data_sort",payload:"unitcode"})},className:"".concat("unitcode"!==a.avl_data_sort_field?"":a.avl_data_sort_ascending?"sort_ascending":"sort_descending")},"Unit")),r.a.createElement("th",null,r.a.createElement("a",{href:"#SortByDateSavedOn",onClick:function(e){e.preventDefault(),t({type:"avl_data_sort",payload:"updated_on"})},className:"".concat("updated_on"!==a.avl_data_sort_field?"":a.avl_data_sort_ascending?"sort_ascending":"sort_descending")},"Data Saved On")),r.a.createElement("th",null,r.a.createElement("a",{href:"#SortByLocationDate",onClick:function(e){e.preventDefault(),t({type:"avl_data_sort",payload:"location_timestamp"})},className:"".concat("location_timestamp"!==a.avl_data_sort_field?"":a.avl_data_sort_ascending?"sort_ascending":"sort_descending")},"Location On")),r.a.createElement("th",null,"Errors"))),r.a.createElement("tbody",null,a.filtered_avl_data.map((function(e){return r.a.createElement(x,Object.assign({key:e.device_id},e))})))))},D=function(){var e=r.a.useContext(d),a=e.state,t=e.dispatch;r.a.useEffect((function(){0===a.avl_data.length&&n()}));var n=function(){var e;return f.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,f.a.awrap(N.Get());case 2:return e=a.sent,a.abrupt("return",t({type:"get_avl_data",payload:e}));case 4:case"end":return a.stop()}}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,null),r.a.createElement("div",{className:"columns main-container"},r.a.createElement("div",{style:{paddingRight:0},className:"column is-one-half left-side"},r.a.createElement(C,null)),r.a.createElement("div",{style:{paddingLeft:0},className:"column is-one-half right-side"})))};i.a.render(r.a.createElement((function(e){var a=Object(n.useReducer)(_,o),t=Object(c.a)(a,2),l=t[0],i=t[1];return r.a.createElement(d.Provider,{value:{state:l,dispatch:i}},e.children)}),null,r.a.createElement(D,null)),document.getElementById("root"))},8:function(e,a,t){e.exports=t(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.3be579ce.chunk.js.map